"use strict";!function(e){e.weui={version:"0.3.0"},e.noop=e.noop||function(){}}($),function(e){var n=null;e.weui.dialog=function(i){i=e.extend({title:"标题",content:"内容",className:"",buttons:[{label:"确定",type:"primary",onClick:e.noop}]},i);var t=i.buttons.map(function(e){return'<a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_'+e.type+'">'+e.label+"</a>"}).join("\n"),a='<div class="'+i.className+'">\n                <div class="weui-mask"></div>\n                <div class="weui-dialog">\n                    <div class="weui-dialog__hd">\n                        <strong class="weui-dialog__title">\n                            '+i.title+'\n                        </strong>\n                    </div>\n                    <div class="weui-dialog__bd">\n                        '+i.content+'\n                    </div>\n                    <div class="weui-dialog__ft">\n                        '+t+"\n                    </div>\n                </div>\n            </div>";n=e(a),e("body").append(n),n.on("click",".weui-dialog__btn",function(){var n=i.buttons[e(this).index()],t=n.onClick||e.noop;t.call(),e.weui.closeDialog()})},e.weui.closeDialog=function(){n&&(n.off("click"),"function"==typeof n.fadeOut?n.fadeOut("fast",function(){n.remove(),n=null}):(n.remove(),n=null))}}($),function(e){e.weui.alert=function(n,i,t){var a="function"==typeof i;a&&(t=i),i=e.extend({title:"警告",content:n||"警告内容",className:"",buttons:[{label:"确定",type:"primary",onClick:t}]},a?{}:i),i.className="weui-dialog_alert "+i.className,e.weui.dialog(i)}}($),function(e){var n=null,i=null;e.weui.topTips=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"topTips",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n&&(n.remove(),i&&clearTimeout(i),n=null),"number"==typeof a&&(a={duration:a}),"function"==typeof a&&(a={callback:a}),a=e.extend({duration:3e3,callback:e.noop},a);var o='<div class="weui-toptips weui-toptips_warn">'+t+"</div>";n=e(o),n.appendTo(e("body")),"function"==typeof n.slideDown?n.slideDown(20):n.show(),i=setTimeout(function(){n&&("function"==typeof n.slideUp?n.slideUp(120,function(){n.remove(),n=null,a.callback()}):(n.remove(),n=null,a.callback()))},a.duration)}}($),function(e){var n=null;e.weui.actionSheet=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[{label:"取消"}],a=i.map(function(e,n){return'<div class="weui-actionsheet__cell">'+e.label+"</div>"}).join(""),o=t.map(function(e,n){return'<div class="weui-actionsheet__cell">'+e.label+"</div>"}).join(""),l='<div>\n            <div class="weui-mask"></div>\n            <div class="weui-actionsheet">\n                <div class="weui-actionsheet__menu">\n                    '+a+'\n                </div>\n                <div class="weui-actionsheet__action">\n                    '+o+"\n                </div>\n            </div>\n        </div>";n=e(l),e("body").append(n),n.find(".weui-mask").show(),n.find(".weui-actionsheet").addClass("weui-actionsheet_toggle"),n.on("click",".weui-actionsheet__menu .weui-actionsheet__cell",function(){var n=i[e(this).index()],t=n.onClick||e.noop;t.call(),e.weui.hideActionSheet()}).on("click",".weui-mask",function(){e.weui.hideActionSheet()}).on("click",".weui-actionsheet__action .weui-actionsheet__cell",function(){var n=t[e(this).index()],i=n.onClick||e.noop;i.call(),e.weui.hideActionSheet()})},e.weui.hideActionSheet=function(){if(n){var e=n.find(".weui-mask"),i=n.find(".weui-actionsheet");e.hide(),i.removeClass("weui-actionsheet_toggle"),i.on("transitionend webkitTransitionEnd",function(){n.remove(),n=null})}}}($),function(e){e.weui.confirm=function(n,i,t,a){var o="function"==typeof i;o&&(a=t,t=i),i=e.extend({title:"确认",content:n||"确认内容",className:"",buttons:[{label:"取消",type:"default",onClick:a||e.noop},{label:"确定",type:"primary",onClick:t||e.noop}]},o?{}:i),i.className="weui-dialog_confirm "+i.className,e.weui.dialog(i)}}($),function(){function e(e){var n=e[0],i=e.val();if("INPUT"==n.tagName||"TEXTAREA"==n.tagName){var t=n.getAttribute("required")||n.getAttribute("pattern")||"";return e.val().length?t?new RegExp(t).test(i)?null:"notMatch":null:"empty"}return"checkbox"==n.getAttribute("type")||"radio"==n.getAttribute("type")?n.checked?null:"empty":i.length?null:"empty"}function n(e){if(e){var n=e.$dom,i=e.msg,t=n.attr(i+"Tips")||n.attr("tips")||n.attr("placeholder");t&&$.weui.topTips(t),n.parents(".weui-cell").addClass("weui-cell_warn")}}var i=$.fn.form;$.fn.form=function(){return this.each(function(i,t){var a=$(t);a.find("[required]").on("blur",function(){var i,t=$(this);t.val().length<1||(i=e(t),i&&n({$dom:t,msg:i}))}).on("focus",function(){var e=$(this);e.parents(".weui-cell").removeClass("weui-cell_warn")})})},$.fn.form.noConflict=function(){return i};var t=$.fn.validate;$.fn.validate=function(i){return this.each(function(){var t=$(this).find("[required]");"function"!=typeof i&&(i=n);for(var a=0,o=t.length;a<o;++a){var l=t.eq(a),u=e(l),s={$dom:l,msg:u};if(u)return void(i(s)||n(s))}i(null)})},$.fn.validate.noConflict=function(){return t}}(),function(e){var n=null;e.weui.loading=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"loading...";if(!n){var t='\n            <div class="weui-loading_toast">\n                <div class="weui-mask_transparent"></div>\n                <div class="weui-toast">\n                    <i class="weui-loading weui-icon_toast"></i>\n                    <p class="weui-toast__content">'+i+"</p>\n                </div>\n            </div>\n        ";n=e(t),e("body").append(n)}},e.weui.hideLoading=function(){n&&n.remove(),n=null}}($),function(e){e.fn.progress=function(n){var i=this;n=e.extend({value:0},n),n.value<0&&(n.value=0),n.value>100&&(n.value=100);var t=this.find(".weui-progress__inner-bar");if(0===t.length){var a="function"==typeof n.onClick?'<a href="javascript:;" class="weui-progress__opr">\n                    <i class="weui-icon-cancel"></i>\n                </a>':"",o='<div class="weui-progress">\n                <div class="weui-progress__bar">\n                    <div class="weui-progress__inner-bar" style="width: '+n.value+'%;"></div>\n                </div>\n                '+a+"\n            </div>";return"function"==typeof n.onClick&&this.on("click",".weui-progress__opr",function(){n.onClick.call(i)}),this.html(o)}return t.width(n.value+"%")}}($),function(e){e.fn.searchBar=function(n){function i(n,i,t){if("function"==typeof t[i]){var a=e(n).val();t[i].call(n,a)}}n=e.extend({focusingClass:"weui-search-bar_focusing",searchText:"搜索",cancelText:"取消"},n);var t='<div class="weui-search-bar">\n                    <form class="weui-search-bar__form">\n                        <div class="weui-search-bar__box">\n                            <i class="weui-icon-search"></i>\n                            <input type="search" class="weui-search-bar__input" id="weui-search-bar__input" placeholder="'+n.searchText+'" required/>\n                            <a href="javascript:" class="weui-icon-clear"></a>\n                        </div>\n                        <label for="weui-search-bar__input" class="weui-search-bar__label">\n                            <i class="weui-icon-search"></i>\n                            <span>'+n.searchText+'</span>\n                        </label>\n                    </form>\n                    <a href="javascript:" class="weui-search-bar__cancel-btn">'+n.cancelText+"</a>\n                </div>",a=e(t);this.append(a);var o=this.find(".weui-search-bar"),l=this.find(".weui-search-bar__label"),u=this.find(".weui-search-bar__input");this.on("focus","#weui-search-bar__input",function(){l.hide(),o.addClass(n.focusingClass),i(u,"onfocus",n)}).on("blur","#weui-search-bar__input",function(){o.removeClass(n.focusingClass),e(this).val()?l.hide():l.show(),i(u,"onblur",n)}).on("touchend",".weui-search-bar__cancel-btn",function(){u.val(""),i(u,"oncancel",n)}).on("touchend",".weui-icon-clear",function(e){e.preventDefault(),u.val(""),"weui-search-bar__input"!=document.activeElement.id&&u.trigger("focus"),i(u,"onclear",n)}).on("input",".weui-search-bar__input",function(){i(u,"input",n)}).on("submit",".weui-search-bar__form",function(){if("function"==typeof n.onsubmit)return i(u,"onsubmit",n),!1})}}($),function(e){var n=e.fn.tab;e.fn.tab=function(n){n=e.extend({defaultIndex:0,activeClass:"weui-bar__item_on",onToggle:e.noop},n);var i=this.find(".weui-tabbar__item, .weui-navbar__item"),t=this.find(".weui-tab__panel");this.toggle=function(e){var a=i.eq(e);a.addClass(n.activeClass).siblings().removeClass(n.activeClass);var o=t.eq(e);o.show().siblings().hide(),n.onToggle(e)};var a=this;return this.on("click",".weui-tabbar__item, .weui-navbar__item",function(n){var i=e(this).index();a.toggle(i)}),this.toggle(n.defaultIndex),this},e.fn.tab.noConflict=function(){return n}}($),function(e){e.weui.toast=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"toast",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"number"==typeof i&&(i={duration:i}),"function"==typeof i&&(i={callback:i}),i=e.extend({duration:3e3,callback:e.noop},i);var t='<div>\n            <div class="weui-mask_transparent"></div>\n            <div class="weui-toast">\n                <i class="weui-icon_toast weui-icon-success-no-circle"></i>\n                <p class="weui-toast__content">'+n+"</p>\n            </div>\n        </div>",a=e(t);e("body").append(a),setTimeout(function(){a.remove(),a=null,i.callback()},i.duration)}}($),function(e){var n=e.fn.uploader;e.fn.uploader=function(n){function i(e){for(var n=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],t=new ArrayBuffer(n.length),a=new Uint8Array(t),o=0;o<n.length;o++)a[o]=n.charCodeAt(o);return new Blob([t],{type:i})}function t(e){var n=c.find(".weui-uploader__file").eq(e);n.addClass("weui-uploader__file_status"),n.html('<div class="weui-uploader__file-content"><i class="weui-icon-warn"></i></div>')}function a(e){var n=c.find(".weui-uploader__file_status").eq(e);n.removeClass("weui-uploader__file-content"),n.html("")}function o(i,o){var l=new FormData;l.append(n.field,i.blob,i.name),e.ajax({type:n.method,url:n.url,data:l,processData:!1,contentType:!1}).success(function(e){a(o),n.onSuccess(e)}).error(function(e){t(o),n.onError(e)}).always(function(){n.onComplete()})}var l=this;n=e.extend({title:"图片上传",maxCount:4,compress:!0,maxWidth:500,auto:!0,field:"file",url:"/upload.php",method:"POST",accept:["image/jpg","image/jpeg","image/png","image/gif"],headers:{},onChange:e.noop,onAddedFile:e.noop,onRemovedfile:e.noop,onError:e.noop,onSuccess:e.noop,onComplete:e.noop},n);var u='<div class="weui-uploader">\n                        <div class="weui-uploader__hd">\n                            <div class="weui-uploader__title">'+n.title+'</div>\n                            <div class="weui-uploader__info">0/'+n.maxCount+'</div>\n                        </div>\n                        <div class="weui-uploader__bd">\n                            <ul class="weui-uploader__files">\n                            </ul>\n                            <div class="weui-uploader__input-box">\n                                <input class="weui-uploader__input" type="file" accept="'+n.accept.join(",")+'">\n                            </div>\n                        </div>\n                    </div>';this.html(u);var s=this,c=this.find(".weui-uploader__files"),r=this.find(".weui-uploader__input"),d=[];return r.on("change",function(t){var a=t.target.files;0!==a.length&&(d.length>=n.maxCount||e.each(a,function(e,t){var a=new FileReader;a.onload=function(e){var a=new Image;a.onload=function(){var e=n.compress?Math.min(n.maxWidth,a.width):a.width,l=a.height*(e/a.width),u=document.createElement("canvas"),r=u.getContext("2d");u.width=e,u.height=l;var f=navigator.userAgent.match(/iPhone OS ([^\s]*)/);f&&7==f[1].substr(0,1)&&3264==a.width&&2448==a.height?r.drawImage(a,0,0,e,2*l):r.drawImage(a,0,0,e,l);var v=u.toDataURL(),p=i(v);d.push({name:t.name,blob:p});var h=URL.createObjectURL(p);c.append('<li class="weui-uploader__file " style="background-image:url('+h+')"></li>'),s.find(".weui-uploader__hd .weui-cell__ft").text(d.length+"/"+n.maxCount),n.onAddedFile({lastModified:t.lastModified,lastModifiedDate:t.lastModifiedDate,name:t.name,size:t.size,type:t.type,data:v,dataURL:v}),n.auto&&o({name:t.name,blob:p},d.length-1),d.length>=n.maxCount&&s.find(".weui-uploader__input-box").hide()},a.src=e.target.result},a.readAsDataURL(t)}))}),this.on("click",".weui-uploader__file",function(){e.weui.confirm("确定删除该图片?",function(){var n=e(l).index();l.remove(n)})}),this.upload=function(){d.map(o)},this.remove=function(e){var i=c.find(".weui-uploader__file").eq(e);i.remove(),d.splice(e,1),n.onRemovedfile(e),d.length<n.maxCount&&s.find(".weui-uploader__input-box").show()},this},e.fn.uploader.noConflict=function(){return n}}($);